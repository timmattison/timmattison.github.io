
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Tim Mattison</title>
  <meta name="author" content="Tim Mattison">

  
  <meta name="description" content="I migrated to WordPress this weekend and after a few bumps in the road I think things are starting to settle.  Old static content is missing and the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.timmattison.com/page/10">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Tim Mattison" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">


<script type="text/javascript">
/* <![CDATA[ */
    (function() {
        var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
        s.type = 'text/javascript';
        s.async = true;
        s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
        t.parentNode.insertBefore(s, t);
    })();
/* ]]> */
</script>


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-46746763-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Tim Mattison</a></h1>
  
    <h2>Hardcore tech</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.timmattison.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2010/10/04/migrated-to-wordpress/">Migrated to WordPress</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-04T08:25:47-04:00" pubdate data-updated="true">Oct 4<span>th</span>, 2010</time>
        
           | <a href="/archives/2010/10/04/migrated-to-wordpress/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2010/10/04/migrated-to-wordpress/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I migrated to WordPress this weekend and after a few bumps in the road I think things are starting to settle.  Old static content is missing and the formatting of old posts probably needs to be touched up but it&rsquo;s a good start for now.</p>

<p>I&rsquo;m going back and I&rsquo;m starting to categorize my articles.  First, one will be called &ldquo;uber&rdquo; and is for the most technical posts.  Then the two other standard categories will be &ldquo;mini-hacks&rdquo; for quick hacks and &ldquo;how-tos&rdquo; for longer how-to type posts.</p>

<p>Comments have moved from Disqus to WordPress for now until I get a chance to install Disqus again.  Any comments between now and then may be lost.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2010/09/28/getting-back-into-the-swing-of-things/">Getting Back Into the Swing of Things</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-28T21:27:15-04:00" pubdate data-updated="true">Sep 28<span>th</span>, 2010</time>
        
           | <a href="/archives/2010/09/28/getting-back-into-the-swing-of-things/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2010/09/28/getting-back-into-the-swing-of-things/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It has been a while but I&rsquo;m starting to get the itch to write some more articles.  Expect some new posts soon.  If you have any requests, let me know!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2010/09/27/listen_to_skidmore_college_radio_wspn_right_on_your_desktop/">Listen to Skidmore College Radio (WSPN) Right on Your Desktop</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-27T10:25:11-04:00" pubdate data-updated="true">Sep 27<span>th</span>, 2010</time>
        
           | <a href="/archives/2010/09/27/listen_to_skidmore_college_radio_wspn_right_on_your_desktop/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2010/09/27/listen_to_skidmore_college_radio_wspn_right_on_your_desktop/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My brother-in-law is going to Skidmore College and just got a radio show.  I don&rsquo;t live close enough to pick it up locally so I put together an app that lets you stream it over the Internet without having your browser open.  It works on Macs, Windows PCs, and Linux boxes so you should be covered.</p>

<p>You&rsquo;ll <a href="http://get.adobe.com/air/">need to have Adobe AIR installed</a> and then you can <a href="/static/WSPNPlayer.air">download my app</a> and listen any time.  Let me know in the comments or via e-mail if you run into any trouble.</p>

<p>Android phones coming soon&hellip;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2009/12/15/how-to-fix-chrome-os-networking-problems-in-vmware-fusion/">How-To: Fix Chrome OS Networking Problems in VMware Fusion</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-12-15T07:54:00-05:00" pubdate data-updated="true">Dec 15<span>th</span>, 2009</time>
        
           | <a href="/archives/2009/12/15/how-to-fix-chrome-os-networking-problems-in-vmware-fusion/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2009/12/15/how-to-fix-chrome-os-networking-problems-in-vmware-fusion/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>gdgt has <a href="http://gdgt.com/google/chrome-os/download/">released a VMware image for Chrome OS</a> this week.  It works on all versions of VMware (not sure about ESX though), Virtual Box, and Parallels.  When I started it up in VMware Fusion I kept getting the message &ldquo;Network not connected and offline login fail&rdquo;.</p>

<p>The instructions explicitly say to switch from NAT to bridged but some users have found that it actually does work just fine with NAT.  In my case it still didn&rsquo;t work with either.  <a href="http://discuss.gdgt.com/google/chrome-os/general/Download-Chrome-OS-VMWare-image/page/2/">Luckily someone on the forums let us in on the secret</a> that you actually don&rsquo;t need a Google account at all to use this build.</p>

<p>If you want to try Chrome OS and you&rsquo;re having networking problems or you don&rsquo;t have a Google account just sign in as &ldquo;<a href="&#x6d;&#97;&#105;&#108;&#x74;&#111;&#58;&#x63;&#104;&#114;&#111;&#x6e;&#x6f;&#115;&#64;&#103;&#109;&#97;&#x69;&#x6c;&#x2e;&#x63;&#111;&#x6d;">&#x63;&#104;&#x72;&#111;&#x6e;&#x6f;&#x73;&#x40;&#x67;&#x6d;&#x61;&#105;&#x6c;&#x2e;&#99;&#x6f;&#x6d;</a>&rdquo; (you can just type &ldquo;chronos&rdquo; and the OS will add &ldquo;@gmail.com&rdquo;) with no password.  You&rsquo;ll be brought straight into the OS without having to sign into Google first.</p>

<p>Surprisingly, after doing that the networking system came to life and I could log into GMail and check other sites.  If you&rsquo;re hung up on getting past the initial login screen definitely try the &ldquo;chronos&rdquo; account and let me know if it works for you.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2009/12/07/tip-monitor-networked-devices-aurally-with-ping-on-mac-os-and-linux/">Tip: Monitor Networked Devices Aurally With Ping on Mac OS and Linux</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-12-07T18:59:59-05:00" pubdate data-updated="true">Dec 7<span>th</span>, 2009</time>
        
           | <a href="/archives/2009/12/07/tip-monitor-networked-devices-aurally-with-ping-on-mac-os-and-linux/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2009/12/07/tip-monitor-networked-devices-aurally-with-ping-on-mac-os-and-linux/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I work with embedded Ethernet devices a lot and I need to monitor them to know exactly when they restart or if they go down during testing.  I used to do it with ping sitting on an external monitor and just glance up at it every few minutes to see what&rsquo;s happening.  This is a less than optimal solution since it requires me to constantly be distracted by a stream of information, it eats up screen real estate, and it forces me to keep an electron inhaling LCD panel running.</p>

<p>I just discovered that the standard ping utility in Linux and Mac OS has a neat feature to alleviate this pain.  It will output an audible bell on every packet either received (showing a device is online) or missed (showing a device is offline). It&rsquo;s your choice which one you use, of course.  Personally, I have only needed the offline alert since I just need to be able to get into devices to see what they&rsquo;re doing immediately after a planned restart.</p>

<p>To get audible notification for every packet missed do this:</p>

<pre><code>ping -A hostname
</code></pre>

<p>To get audible notification for every packet received do this:</p>

<pre><code>ping -a hostname
</code></pre>

<p>Now you can work without distraction until you hear those <a href="http://en.wikipedia.org/wiki/Bell_character">BEL</a>s.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2009/12/07/how-to-fix-unresolved-moddi3-symbols-when-developing-linux-kernel-modules/">How-To: Fix Unresolved _moddi3 Symbols When Developing Linux Kernel Modules</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-12-07T18:59:59-05:00" pubdate data-updated="true">Dec 7<span>th</span>, 2009</time>
        
           | <a href="/archives/2009/12/07/how-to-fix-unresolved-moddi3-symbols-when-developing-linux-kernel-modules/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2009/12/07/how-to-fix-unresolved-moddi3-symbols-when-developing-linux-kernel-modules/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When developing Linux kernel modules, specifically ones that tie into procfs via the seq_file interfaces and have circular buffers, it&rsquo;s handy to be able to take an offset into your buffer and use the modulo operator (%) to make it wrap around easily.  In the kernel you&rsquo;re restricted to a smaller set of available operators however and modulo only works on certain types.</p>

<p>One type that it doesn&rsquo;t work on that happens to be used in the seq_file interface is loff_t.  If you try something like this:</p>

<pre><code>static void *my_procfs_seq_start(struct seq_file *s, loff_t *pos)
{
  return global_pointer + ((*pos) % CIRCULAR_BUFFER_SIZE);
}
</code></pre>

<p>You will probably get an error about the unresolved symbol &ldquo;_moddi3&rdquo;.  The quick fix for this is to do the following instead:</p>

<pre><code>static void *my_procfs_seq_start(struct seq_file *s, loff_t *pos)
{
  return global_pointer + (((int) (*pos)) % CIRCULAR_BUFFER_SIZE);
}
</code></pre>

<p>This simply converts your dereferenced loff_t pointer to an int.  <strong>Make sure your value will fit into your architecture&rsquo;s int size!</strong>.  If it doesn&rsquo;t, you&#8217;ll get strange results.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2009/12/01/how-to-fix-issues-with-vmware-server-tools-on-gentoo-and-other-distros/">How-To: Fix Issues With VMware Server Tools on Gentoo (and Other Distros)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-12-01T18:59:59-05:00" pubdate data-updated="true">Dec 1<span>st</span>, 2009</time>
        
           | <a href="/archives/2009/12/01/how-to-fix-issues-with-vmware-server-tools-on-gentoo-and-other-distros/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2009/12/01/how-to-fix-issues-with-vmware-server-tools-on-gentoo-and-other-distros/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>VMware Server is a complicated beast.  When it breaks, you&rsquo;re usually without support (although <a href="mailto:sales@vmware.com">paid support options do exist</a>), and out of commission.  One problem that tripped me up for a few weeks was that I had a running VM that refused to suspend.  Because of this I couldn&rsquo;t get clean backups of the VM in a suspended state and had to resort to just a plain backup of the filesystem via rsync.  It worked, but it was less than optimal.  Any time I ran the suspend command:</p>

<pre><code>/opt/vmware/bin/vmrun suspend Gentoo.vmx
</code></pre>

<p>The error message I was presented with was:</p>

<pre><code>Error: Command failed: Cannot connect to the virtual machine
</code></pre>

<p>I could hobble along like this for a while but today I needed to add another virtual disk which required a restart of the VM.  When I tried to start it via the command-line tools like this:</p>

<pre><code>/opt/vmware/bin/vmrun start Gentoo.vmx
</code></pre>

<p>The system just hung indefinitely.  Eventually I had to CTRL-C out of it and get back to the command-line to figure out the issue.</p>

<p>What was the underlying problem?  Almost every time I&rsquo;ve had a VMware Server issue it has been permissions.  When you&rsquo;re working with VMs you should always make sure that the following criteria is applied to the files in the VM&rsquo;s working directory:</p>

<ul>
<li><p>All files must be owned by the vmware user and/or the vmware group</p></li>
<li><p>All of the files must be readable and writeable by the vmware user and/or group</p></li>
<li><p>Disk files must be marked as executable by the vmware user and/or group</p></li>
<li><p>Optional: All permissions should be removed from anyone other than the owning user and/or group</p></li>
</ul>


<p>What I do to get this done quickly on all of my VMs is run the following few commands in each VM&rsquo;s working directory:</p>

<pre><code>chgrp vmware *
chmod 660 *vmem
chmod 660 *.vmsn
chmod 750 *.vmdk
chmod 750 *.vmsd
chmod 750 nvram
</code></pre>

<p>After running those few commands VMware Server works like a charm again.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2009/11/29/how-to-setup-streaming-mp4-video-on-your-own-gentoo-server-and-other-distros/">How-To: Setup Streaming MP4 Video on Your Own Gentoo Server (and Other Distros)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-29T22:52:59-05:00" pubdate data-updated="true">Nov 29<span>th</span>, 2009</time>
        
           | <a href="/archives/2009/11/29/how-to-setup-streaming-mp4-video-on-your-own-gentoo-server-and-other-distros/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2009/11/29/how-to-setup-streaming-mp4-video-on-your-own-gentoo-server-and-other-distros/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>With so many free streaming services available today (<a href="http://www.vimeo.com">Vimeo</a> being the best and <a href="http://www.youtube.com">YouTube</a> being the most widely recognized) you might wonder why someone would want to host their own videos.  My main reason is so that I can more easily see who watches my content.  Other reasons include better access control if your videos are personal in nature, or a more integrated, branded user experience if you&rsquo;re producing content that is subscription, pay-per-view or ad supported.  You might also want to get around the restrictions that come with the free accounts these sites offer without paying for their premium services.  If you&rsquo;re already invested in the hardware to host your site and you can support the bandwidth requirements for your expected traffic volume then it might make sense to host things yourself.</p>

<p>So, what&rsquo;s the big deal?  If you&rsquo;re looking to get started right away you can render an MP4 file, install a free player like <a href="http://flowplayer.org/">FlowPlayer</a>, and start hosting video in 5 minutes.  The problem that you&rsquo;ll notice straight away is that your videos have to buffer completely (ie. the user&rsquo;s browser downloads the whole video) before they start playing.  For short videos or video files that are small this isn&rsquo;t a big deal.  But for HD videos and videos that are long in duration the delay can cause even the most patient viewers navigate away from your site.  Since all of the other services have gotten users accustomed to video playing immediately it&rsquo;s hard to justify this kind of behavior on any site today.</p>

<p>I&rsquo;ve figured out the secret sauce to get this working.  Now you can do it too with just these few simple steps:</p>

<ul>
<li><p>Step 1: Render your MP4 files and place them on your server</p></li>
<li><p>Step 2: Create a webpage with <a href="http://flowplayer.org/">FlowPlayer</a> embedded.  A template to get you started looks like this:</p>

<p><head>
<script type="text/javascript" src="http://your-site.com/flowplayer-3.2.4.min.js"></script>
</head></p>

<p><a href="http://your-site.com/your-video.mp4" style="display:block;width:800px;height:475px" id="player"> </a></p>

<p><script>flowplayer(&ldquo;player&rdquo;, &ldquo;flowplayer-3.2.5.swf&rdquo;,</p>

<p>{ clip:
  { url: &ldquo;<a href="http://your-site.com/your-video.mp4">http://your-site.com/your-video.mp4</a>&rdquo;,
    duration: 120,
    metadata: false,
    autoPlay: true,
    autoBuffer: true,
    bufferLength: 3,
    linkUrl: &ldquo;<a href="http://your-site.com/your-video-description.html">http://your-site.com/your-video-description.html</a>&rdquo;
  }
});</script></p></li>
</ul>


<p>Just replace your-site.com/your-video.mp4 with the real URL of your MP4 video and your-site.com/your-video-description.html with the site you want to link the user to if they click on the video while it&rsquo;s playing.  Also, replace &ldquo;120&rdquo; after the duration variable with the actual duration of your video in seconds.  If you don&rsquo;t know this value, or you&rsquo;re feeling lazy, you can set it to zero and FlowPlayer will figure it out for you.  Don&rsquo;t set it too short or your video will end prematurely and make sure that flowplayer-3.1.4.min.js is on your server in the appropriate location.  This example assumes it is in the root directory.</p>

<ul>
<li><p>Step 3: Download and install mod_h264 for Apache.  There are instructions for <a href="http://h264.code-shop.com/trac/wiki/Mod-H264-Streaming-Apache-Version2">distros other than Gentoo</a> or youcan run these commands on Gentoo to do it all:</p>

<p>cd /tmp
wget <a href="http://h264.code-shop.com/download/apache_mod_h264_streaming-2.2.5.tar.gz">http://h264.code-shop.com/download/apache_mod_h264_streaming-2.2.5.tar.gz</a>
tar xzvf apache_mod_h264_streaming-2.2.5.tar.gz
rm apache_mod_h264_streaming-2.2.5.tar.gz
cd mod_h264_streaming-2.2.5
./configure
sudo make install</p></li>
<li><p>Step 4: Add mod_h264 for your Apache configuration.  Append these lines to the bottom of your /etc/apache/httpd.conf:</p>

<p>LoadModule h264_streaming_module /usr/lib/apache2/modules/mod_h264_streaming.so
AddHandler h264-streaming.extensions .mp4</p></li>
<li><p>Step 5: Restart apache with</p>

<p>/etc/init.d/apache restart</p></li>
<li><p>Step 6: Test out your streaming video.  If all went well then you&rsquo;ll see the bar behind the playhead fill in as the video buffers.</p></li>
</ul>


<p>That&rsquo;s all there is to it.  Thanks to the mod_h264 developers (and these instructions) you&rsquo;re now able to stream MP4 video like the big guys.  Here&rsquo;s an example of what it should look like (the source material in this video is from <a href="http://freestockphotos.com/">FreeStockPhotos.com</a> but the controls in the player cut off their watermark):</p>

<p><a href="http://blog.timmattison.com/static/howto-test.mp4"> </a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2009/11/24/how-to-disable-screen-blanking-in-x-on-gentoo-and-other-distros/">How-To: Disable Screen Blanking in X on Gentoo (and Other Distros)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-24T07:12:28-05:00" pubdate data-updated="true">Nov 24<span>th</span>, 2009</time>
        
           | <a href="/archives/2009/11/24/how-to-disable-screen-blanking-in-x-on-gentoo-and-other-distros/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2009/11/24/how-to-disable-screen-blanking-in-x-on-gentoo-and-other-distros/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Even though I have a nice dual monitor setup in my office I tend to use my laptop for almost everything.  The dual monitor system ends up holding a bunch of diagnostic and performance information (top, PProcM, tail of application/database logs, etc)  about the various machines I&rsquo;m working on.  Because of this I&rsquo;m almost never using the keyboard and mouse on that machine and in fact it often doesn&rsquo;t have a keyboard and mouse hooked up.  Typically I just access it just using <a href="http://www.karlrunge.com/x11vnc/">x11vnc</a> so I don&rsquo;t have to switch my wireless mouse over or go find a free keyboard.</p>

<p>The problem is that the screen blanker kicks in every 15 minutes or so.  I got tired of reconnecting via VNC to turn the displays back on so I just did a quick mod to my /etc/X11/xorg.conf and now I just turn the displays off manually whenever I don&rsquo;t need them.  If you want to do the same thing just add the following section right before the input device section (found on <a href="http://www.linuxquestions.org/questions/slackware-14/cannot-unset-powersave-mode-582229/">these forums</a>):</p>

<pre><code>Section "ServerFlags"
    Option         "blank time" "0"
    Option         "standby time" "0"
    Option         "suspend time" "0"
    Option         "off time" "0"
EndSection
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2009/11/24/how-to-fix-error-function-information-schema-pg-keypositions-does-not-exist-in-postgresql-when-using-hibernate/">How-To: Fix &#8220;ERROR: Function information_schema._pg_keypositions() Does Not Exist&#8221; in PostgreSQL When Using Hibernate</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-24T07:01:25-05:00" pubdate data-updated="true">Nov 24<span>th</span>, 2009</time>
        
           | <a href="/archives/2009/11/24/how-to-fix-error-function-information-schema-pg-keypositions-does-not-exist-in-postgresql-when-using-hibernate/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2009/11/24/how-to-fix-error-function-information-schema-pg-keypositions-does-not-exist-in-postgresql-when-using-hibernate/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ll keep this one short.  If you&rsquo;re writing and debugging a Hibernate application and you&rsquo;re using PostgreSQL you may notice that you get the following error message when your application first connects to the database:</p>

<pre><code>ERROR:  function information_schema._pg_keypositions() does not exist
</code></pre>

<p>According to <a href="http://qaix.com/postgresql-database-development/445-710-information-schema-pg-keypositions-in-8-1-read.shtml">a forum I came across</a> this is because the Hibernate team ended up depending on a function in PostgreSQL 8.0 that was dropped in 8.1+.  I needed to make some modifications to the code posted there to get it to work so here&rsquo;s what I came up with:</p>

<pre><code>CREATE FUNCTION information_schema._pg_keypositions() RETURNS SETOF integer
LANGUAGE sql
IMMUTABLE
AS $pg_keypositions$
select g.s
from generate_series(1,current_setting('max_index_keys')::int, 1)
as g(s)
$pg_keypositions$;
</code></pre>

<p>Once you run this code in your database you&rsquo;ll never be bothered with that error message again.  Basically this just gets the max_index_keys value and generates a list of integers from 1 to that value, inclusive.  Hibernate can live without it but removing a repetitive error message will keep your DBA and sysadmins sane a bit longer.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/11/">&larr; Older</a>
    
    <a href="/archives">Archives</a>
    
    <a class="next" href="/page/9/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Sidebar -->
<ins class="adsbygoogle"
     style="display:inline-block;width:120px;height:240px"
     data-ad-client="ca-pub-9307090849713032"
     data-ad-slot="1616086903"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/archives/2015/07/30/image-metadata-extraction-with-aws-lambda-and-java/">Image Metadata Extraction With AWS Lambda and Java</a>
      </li>
    
      <li class="post">
        <a href="/archives/2015/07/30/deploying-multiple-java-applications-in-a-single-elastic-beanstalk-instance/">Deploying Multiple Java Applications in a Single Elastic Beanstalk Instance</a>
      </li>
    
      <li class="post">
        <a href="/archives/2015/07/27/deploying-multiple-war-files-on-a-single-instance-with-elastic-beanstalks-command-line-tools/">Deploying Multiple WAR Files on a Single Instance With Elastic Beanstalk&#8217;s Command-line Tools</a>
      </li>
    
      <li class="post">
        <a href="/archives/2015/07/24/how-would-you-implement-cron-on-aws-as-inexpensively-as-possible/">How Would You Implement &#8220;Cron&#8221; on AWS as Inexpensively as Possible?</a>
      </li>
    
      <li class="post">
        <a href="/archives/2015/03/10/validating-guava-event-bus-interactions-with-mockito/">Validating Guava Event Bus Interactions With Mockito</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/timmattison">@timmattison</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'timmattison',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/timmattison?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Tim Mattison -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'timmattison';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
