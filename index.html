
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Tim Mattison</title>
  <meta name="author" content="Tim Mattison">

  
  <meta name="description" content="I just started a repo to keep track of my AWS Lambda (Java) experiments. The first experiment is using Java to extract metadata from an uploaded &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.timmattison.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Tim Mattison" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">


<script type="text/javascript">
/* <![CDATA[ */
    (function() {
        var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
        s.type = 'text/javascript';
        s.async = true;
        s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
        t.parentNode.insertBefore(s, t);
    })();
/* ]]> */
</script>


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-46746763-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Tim Mattison</a></h1>
  
    <h2>Hardcore tech</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.timmattison.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2015/07/30/image-metadata-extraction-with-aws-lambda-and-java/">Image Metadata Extraction With AWS Lambda and Java</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-07-30T16:40:14-04:00" pubdate data-updated="true">Jul 30<span>th</span>, 2015</time>
        
           | <a href="/archives/2015/07/30/image-metadata-extraction-with-aws-lambda-and-java/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2015/07/30/image-metadata-extraction-with-aws-lambda-and-java/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I just started a repo to keep track of <a href="https://github.com/timmattison/aws-lambda-playground">my AWS Lambda (Java) experiments</a>.  The first experiment is using Java to extract metadata from an uploaded image.  It is a bit unconventional because it doesn&rsquo;t use S3 but that was done to make the setup simpler.  Here&rsquo;s how you can play around with the metadata extractor&hellip;</p>

<p>This tutorial will walk you through getting the metadata extractor set up, calling it, and then tearing it down.  The commands in this tutorial assume you are in the <code>metadata-extractor</code> directory.</p>

<p><strong><em>NOTE</em></strong>: Do not forget to do step 5 &ndash; &ldquo;Tear down your function&rdquo; &ndash; or you may be sorry!</p>

<h2>Step 1: Build the JAR</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn clean compile test package</span></code></pre></td></tr></table></div></figure>


<p>You should get a <code>BUILD SUCCESS</code> if everything worked.</p>

<h2>Step 2: Create the Lambda function</h2>

<p>Navigate to <a href="https://console.aws.amazon.com/lambda/home?region=us-east-1#/create?step=2">step 2 of the AWS Lambda creation process</a> (step 1 is selecting a blueprint/template which we do not want to do).</p>

<ul>
<li>Name your function <code>metadata-extractor</code></li>
<li>Enter a description if you want</li>
<li>Set the runtime to <code>Java 8</code></li>
<li>Select <code>Upload a ZIP file</code> (it should be selected by default)</li>
<li>Click &ldquo;Upload&rdquo; and select the file <code>metadata-extractor-1.0-SNAPSHOT-jar-with-dependencies.jar</code> from the <code>metadata-extractor/target</code> directory</li>
<li>Set the handler to <code>com.timmattison.ImageHandler::handleRequest</code></li>
<li>Set the role to <code>Basic execution role</code> or <code>lambda_basic_execution</code>, whichever exists.  NOTE: If you have popups disabled this may continually tell you that you didn&rsquo;t fill the field in.  You MUST enable popups to get this to work.</li>
<li>Set the memory to <code>128 MB</code></li>
<li>Set the timeout to <code>5 seconds</code></li>
<li>Click <code>Next</code></li>
<li>Click <code>Create function</code></li>
</ul>


<h2>Step 3: Create a public endpoint that you can test</h2>

<p>You should now be on a screen that says &ldquo;Lambda > Functions > metadata-extractor&rdquo;.  There should be five tabs visible.  They are &ldquo;Code&rdquo;, &ldquo;Configuration&rdquo;, &ldquo;Event sources&rdquo;, &ldquo;API endpoints&rdquo;, &ldquo;Monitoring&rdquo;.</p>

<ul>
<li>Click on the <code>API endpoints</code> tab</li>
<li>Click <code>Add API endpoint</code></li>
<li>Set <code>API name</code> to <code>LambdaMicroservice</code></li>
<li>Set <code>Resource name</code> to <code>metadata-extractor</code></li>
<li>Set <code>Method</code> to <code>POST</code></li>
<li>Set <code>Deployment stage</code> to <code>prod</code></li>
<li>Set <code>Security</code> to <code>Open</code> (we will destroy this service later so it can&rsquo;t be abused)</li>
<li>Click <code>Add API endpoint</code></li>
</ul>


<p>You should now see a table with three columns.  The rightmost column &ldquo;API endpoint URL&rdquo; contains the URL for the endpoint you just created.  It should be similar to this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>https://xxxxxxxxxxx.execute-api.us-east-1.amazonaws.com/prod/metadata-extractor</span></code></pre></td></tr></table></div></figure>


<p>Copy that somewhere where you can get to it later.</p>

<h2>Step 4: Upload an image to the URL</h2>

<p>Now you&rsquo;re ready to upload an image to the URL you just created.  Lambda is expecting data in JSON format, not binary uploads.  We do something a bit hacky to make our lives easier here.  We take the image, convert it to base64, and put it into a JSON object before we upload it.  This is done with the Python script called <code>convert-image-to-json.py</code>.  Assuming your image is called <code>myimage.jpg</code> and your URL is <code>https://xxxxxxxxxxx.execute-api.us-east-1.amazonaws.com/prod/metadata-extractor</code> you would do this to upload your image.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ./convert-image-to-json.py myimage.jpg | curl -X POST https://xxxxxxxxxxx.execute-api.us-east-1.amazonaws.com/prod/metadata-extractor -d@-</span></code></pre></td></tr></table></div></figure>


<p>If your image contains any metadata you&rsquo;ll get a response that contains a bunch of interesting info.  Here are the results from one PNG I had lying around:</p>

<blockquote><p>&ldquo;[PNG-IHDR] Image Width &ndash; 332, [PNG-IHDR] Image Height &ndash; 48, [PNG-IHDR] Bits Per Sample &ndash; 8, [PNG-IHDR] Color Type &ndash; True Color with Alpha, [PNG-IHDR] Compression Type &ndash; Deflate, [PNG-IHDR] Filter Method &ndash; Adaptive, [PNG-IHDR] Interlace Method &ndash; No Interlace, [PNG-iCCP] ICC Profile Name &ndash; ICC Profile, [ICC Profile] Profile Size &ndash; 1960, [ICC Profile] CMM Type &ndash; appl, [ICC Profile] Version &ndash; 2.2.0, [ICC Profile] Class &ndash; Display Device, [ICC Profile] Color space &ndash; RGB , [ICC Profile] Profile Connection Space &ndash; XYZ , [ICC Profile] Profile Date/Time &ndash; Wed Mar 25 11:26:11 UTC 2009, [ICC Profile] Signature &ndash; acsp, [ICC Profile] Primary Platform &ndash; Apple Computer, Inc., [ICC Profile] Device manufacturer &ndash; appl, [ICC Profile] XYZ values &ndash; 0.9642029 1.0 0.8249054, [ICC Profile] Tag Count &ndash; 11, [ICC Profile] Profile Description &ndash; Generic RGB Profile, [ICC Profile] Apple Multi-language Profile Name &ndash; 30 skSK(Všeobecný RGB profil) hrHR(Generički RGB profil) caES(Perfil RGB genèric) ptBR(Perfil RGB Genérico) ukUA(Загальний профайл RGB) frFU(Profil générique RVB) zhTW(通用 RGB 色彩描述) itIT(Profilo RGB generico) nbNO(Generisk RGB-profil) koKR(일반 RGB 프로파일) csCZ(Obecný RGB profil) heIL(פרופיל RGB כללי) deDE(Allgemeines RGB-Profil) huHU(Általános RGB profil) svSE(Generisk RGB-profil) zhCN(普通 RGB 描述文件) jaJP(一般 RGB プロファイル) roRO(Profil RGB generic) elGR(Γενικό προφίλ RGB) ptPO(Perfil RGB genérico) nlNL(Algemeen RGB-profiel) esES(Perfil RGB genérico) thTH(โปรไฟล์ RGB ทั่วไป) trTR(Genel RGB Profili) fiFI(Yleinen RGB-profiili) plPL(Uniwersalny profil RGB) ruRU(Общий профиль RGB) arEG(ملف تعريف RGB العام) enUS(Generic RGB Profile) daDK(Generel RGB-beskrivelse), [ICC Profile] Copyright &ndash; Copyright 2007 Apple Inc., all rights reserved., [ICC Profile] Media White Point &ndash; (0.95047, 1.0, 1.0890961), [ICC Profile] Red Colorant &ndash; (0.45429993, 0.24191284, 0.014892578), [ICC Profile] Green Colorant &ndash; (0.35334778, 0.67362976, 0.09063721), [ICC Profile] Blue Colorant &ndash; (0.15664673, 0.0844574, 0.719574), [ICC Profile] Red TRC &ndash; 0.0070344, [ICC Profile] Chromatic Adaptation &ndash; sf32(0x73663332): 44 bytes, [ICC Profile] Blue TRC &ndash; 0.0070344, [ICC Profile] Green TRC &ndash; 0.0070344&rdquo;
&#8220;`</p></blockquote>

<h2>Step 5: Tear down your function</h2>

<p>The function you&rsquo;ve created is now publicly accessible.  That means that if someone finds it they can hit it and start costing you real money.  It is in your best interest to shut this function down when you&rsquo;re done with it.</p>

<ul>
<li>Click <code>Actions</code></li>
<li>Click <code>Delete function</code></li>
<li>Click <code>Delete</code></li>
</ul>


<p>You&rsquo;re done!  Have fun!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2015/07/30/deploying-multiple-java-applications-in-a-single-elastic-beanstalk-instance/">Deploying Multiple Java Applications in a Single Elastic Beanstalk Instance</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-07-30T07:16:29-04:00" pubdate data-updated="true">Jul 30<span>th</span>, 2015</time>
        
           | <a href="/archives/2015/07/30/deploying-multiple-java-applications-in-a-single-elastic-beanstalk-instance/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2015/07/30/deploying-multiple-java-applications-in-a-single-elastic-beanstalk-instance/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today I released a Python script called <a href="https://github.com/timmattison/quick-deploy-java">quick-deploy-java</a> that makes it easier to deploy multiple Java applications (WARs) to a single Elastic Beanstalk instance.</p>

<p>Want to give it a shot?  Clone the repo and follow along with this tutorial.</p>

<h2>Step 1: Create a directory for your application and navigate to that directory</h2>

<p>We&rsquo;ll call this <code>eb-test</code>.  We assume that you&rsquo;ll do this from the same directory that this <code>TUTORIAL.md</code> file is located.  If you do not the instructions later will need to incorporate the proper paths.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mkdir eb-test
</span><span class='line'>$ cd eb-test</span></code></pre></td></tr></table></div></figure>


<h2>Step 2: Run <code>eb init</code> to create your application in Elastic Beanstalk</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ eb init</span></code></pre></td></tr></table></div></figure>


<p>I used the following values:</p>

<h3>Region &ndash; us-east-1</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Select a default region
</span><span class='line'>1) us-east-1 : US East (N. Virginia)
</span><span class='line'>2) us-west-1 : US West (N. California)
</span><span class='line'>3) us-west-2 : US West (Oregon)
</span><span class='line'>4) eu-west-1 : EU (Ireland)
</span><span class='line'>5) eu-central-1 : EU (Frankfurt)
</span><span class='line'>6) ap-southeast-1 : Asia Pacific (Singapore)
</span><span class='line'>7) ap-southeast-2 : Asia Pacific (Sydney)
</span><span class='line'>8) ap-northeast-1 : Asia Pacific (Tokyo)
</span><span class='line'>9) sa-east-1 : South America (Sao Paulo)
</span><span class='line'>(default is 3): 1</span></code></pre></td></tr></table></div></figure>


<h3>Application name &ndash; eb-test</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Enter Application Name
</span><span class='line'>(default is "eb-test"): 
</span><span class='line'>Application eb-test has been created.</span></code></pre></td></tr></table></div></figure>


<h3>Platform &ndash; Tomcat</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Select a platform.
</span><span class='line'>1) Node.js
</span><span class='line'>2) PHP
</span><span class='line'>3) Python
</span><span class='line'>4) Ruby
</span><span class='line'>5) Tomcat
</span><span class='line'>6) IIS
</span><span class='line'>7) Docker
</span><span class='line'>8) Multi-container Docker
</span><span class='line'>9) GlassFish
</span><span class='line'>10) Go
</span><span class='line'>(default is 1): 5</span></code></pre></td></tr></table></div></figure>


<h3>Platform version &ndash; Tomcat 8 Java 8</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Select a platform version.
</span><span class='line'>1) Tomcat 8 Java 8
</span><span class='line'>2) Tomcat 7 Java 7
</span><span class='line'>3) Tomcat 7 Java 6
</span><span class='line'>4) Tomcat 7
</span><span class='line'>5) Tomcat 6
</span><span class='line'>(default is 1): 1</span></code></pre></td></tr></table></div></figure>


<h3>SSH &ndash; yes</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Do you want to set up SSH for your instances?
</span><span class='line'>(y/n): y</span></code></pre></td></tr></table></div></figure>


<h3>Keypair &ndash; existing</h3>

<p>I already had a keypair called aws-eb that I use.  You can reuse an existing one or create a new one.  It shouldn&rsquo;t matter.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Select a keypair.
</span><span class='line'>1) aws-eb
</span><span class='line'>2) [ Create new KeyPair ]
</span><span class='line'>(default is 2): 1</span></code></pre></td></tr></table></div></figure>


<h1>Step 3: Create a testing environment</h1>

<p>Since no applications are in this directory it will also launch the sample application.  On my system this step took about 4 minutes.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ eb create testing</span></code></pre></td></tr></table></div></figure>


<p>The output you&rsquo;ll see will start with something similar to this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>WARNING: The current directory does not contain any source code. Elastic Beanstalk is launching the sample application instead.
</span><span class='line'>Environment details for: testing
</span><span class='line'>  Application name: eb-test
</span><span class='line'>  Region: us-east-1
</span><span class='line'>  Deployed Version: Sample Application</span></code></pre></td></tr></table></div></figure>


<p>Once it is done you&rsquo;ll see this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>INFO: Successfully launched environment: testing</span></code></pre></td></tr></table></div></figure>


<h1>Step 4: Validate that the default environment is running</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ eb open</span></code></pre></td></tr></table></div></figure>


<p>You should see a page in your web browser that looks like this:</p>

<p><img src="default-application.png" alt="Default Tomcat 8 Java 8 application" /></p>

<h1>Step 5: Deploy the first toy application by itself</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ../quick-deploy.py . ../example-applications/application1/
</span><span class='line'>Building ROOT application...
</span><span class='line'>ROOT application built
</span><span class='line'>Deploying application.  This can take a long time.
</span><span class='line'>Application deployed</span></code></pre></td></tr></table></div></figure>


<p>This may take several minutes.  Once it is complete you can verify that it is running by doing this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ eb open</span></code></pre></td></tr></table></div></figure>


<p>In your browser you should see a simple page that says something like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>This is application1 and it prints out a big random number 1555709810405276531</span></code></pre></td></tr></table></div></figure>


<p>The random number at the end will be different.</p>

<p>At this point you&rsquo;ve deployed a single application to a single instance.  Now we&rsquo;ll deploy three applications to the same instance.</p>

<h1>Step 6: Deploy three applications to the same instance</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ../quick-deploy.py . ../example-applications/application1/ ../example-applications/application1/ 1 ../example-applications/application2/ 2
</span><span class='line'>Building ROOT application...
</span><span class='line'>ROOT application built
</span><span class='line'>Building 1 application...
</span><span class='line'>Building 2 application...
</span><span class='line'>Deploying application.  This can take a long time.
</span><span class='line'>Application deployed</span></code></pre></td></tr></table></div></figure>


<p>This took about 4 minutes on my system.  At this point open the application again:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ eb open</span></code></pre></td></tr></table></div></figure>


<p>Make sure that the random number has changed.  This shows that you&rsquo;ve got a new instance of the application.</p>

<p>Now add <code>/1</code> to the URL in your address bar and load the page.  You should see the same message but again with another new number.  This shows that you have a second copy of the application running at a new path.</p>

<p>Finally replace <code>/1</code> with <code>/2</code> in the URL in your address bar and load the page.  You should see exactly this message in your browser:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>This is application2 and it just prints out this message</span></code></pre></td></tr></table></div></figure>


<p>If everything worked out you now have an Elastic Beanstalk configuration that is running three applications in a single instance.  <code>application1</code> is running at the root and at the <code>1</code> path while <code>application1</code> is running at the <code>2</code> path.</p>

<h1>Step 7: Terminate your application</h1>

<p>Make sure you terminate your application when you&rsquo;re done.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ eb terminate</span></code></pre></td></tr></table></div></figure>


<p>If you forget to do this step Amazon will keep your application running and keep billing you!  If you want to be extra thorough go into the <a href="https://console.aws.amazon.com/elasticbeanstalk/home">AWS Elastic Beanstalk console</a> and delete the application completely.</p>

<p>You should also go into S3 and delete any files that are left behind.  They don&rsquo;t take up much space but keeping S3 tidy for when you start making real use of Elastic Beanstalk makes sense.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2015/07/27/deploying-multiple-war-files-on-a-single-instance-with-elastic-beanstalks-command-line-tools/">Deploying Multiple WAR Files on a Single Instance With Elastic Beanstalk&#8217;s Command-line Tools</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-07-27T17:22:30-04:00" pubdate data-updated="true">Jul 27<span>th</span>, 2015</time>
        
           | <a href="/archives/2015/07/27/deploying-multiple-war-files-on-a-single-instance-with-elastic-beanstalks-command-line-tools/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2015/07/27/deploying-multiple-war-files-on-a-single-instance-with-elastic-beanstalks-command-line-tools/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong><em>UPDATE</em></strong> 2015-07-31: Removed the section about <code>.ebextensions</code>.  I have confirmed that this is not needed.  This mistake was an artifact of my troubleshooting process.</p>

<p><strong><em>UPDATE</em></strong> 2015-07-28: I briefly talked to <a href="https://twitter.com/nhumrich">Nick Humrich</a> and <a href="https://twitter.com/abhik5ingh">Abhishek K Singh</a> on Twitter, pointed them to this article, and it was fixed in less than 24 hours.  Nice work!  If you update your EB CLI tools to 3.4.7 or greater the bug will be fixed for you and you can ignore the rest of this article.</p>

<p>In June this year <a href="http://aws.amazon.com/about-aws/whats-new/2015/06/aws-elastic-beanstalk-supports-multiple-war-files-and-m4-instances/">AWS added the ability to run multiple WAR files with Elastic Beanstalk in a single EC2 instance</a>.  This makes deploying several small applications a lot more cost effective.</p>

<p>In order to do this you need to create a ZIP file containing all of the WAR files you want to deploy <del>and you <strong><em>must</em></strong> include a directory called <code>.ebextensions</code> even if it is empty.  In my case I just added and empty file called <code>.ebextensions/README.md</code> to make it happy.  Obviously if you use <code>.ebextensions</code> for any kind of customization you won&rsquo;t need to do anything</del>.</p>

<p>When Elastic Beanstalk sees that you&rsquo;ve deployed a file like this it treats it differently than a normal bundle.  It takes the WAR file called <code>ROOT.war</code> and deploys that as the root application.  The rest of the WAR files are deployed in directories derived from their file names.  For example, <code>application1.war</code> would be accessed through the <code>/application1</code> path.</p>

<p>Deploying with <code>eb deploy</code> creates a ZIP file that includes everything in your current directory.  The problem is that <code>eb init</code> creates a <code>.gitignore</code> file in your deployment directory.  <code>eb deploy</code> picks that up that <code>.gitignore</code> and adds it to the archive.  On the EC2 instance that runs your application it sees that your archive doesn&rsquo;t contain just WAR files and the <code>.ebextensions</code> directory and it treats it like a normal single application deployment.  If/when this happens you&rsquo;ll see that you just get your WAR files placed in the <code>/var/lib/tomcat8/webapps/ROOT</code> directory.</p>

<p>There are two possible fixes for this problem.</p>

<p>Solution #1: You can just delete the <code>.gitignore</code> file.  IMHO, this isn&rsquo;t a great solution since you need to remember to do it for each project.</p>

<p>Solution #2: You can patch the Python code that creates the ZIP archive and tell it to ignore the <code>.gitignore</code> file.  To do that you need to modify your <code>ebcli/core/fileoperations.py</code> file.  On my system, since I&rsquo;m not using <code>pip</code>, it was located at <code>~/.ebvenv/lib/python2.7/site-packages/ebcli/core/fileoperations.py</code>.  If you use <code>pip</code> or another package manager it will probably be in a different location.</p>

<p>The function you need to modify is called <code>zip_up_folder</code>.  My original version looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">zip_up_folder</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">ignore_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
</span><span class='line'>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span class='line'>    <span class="k">try</span><span class="p">:</span>
</span><span class='line'>        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span><span class='line'>        <span class="n">io</span><span class="o">.</span><span class="n">log_info</span><span class="p">(</span><span class="s">&#39;Zipping up folder at location: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
</span><span class='line'>        <span class="n">zipf</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_DEFLATED</span><span class="p">)</span>
</span><span class='line'>        <span class="n">_zipdir</span><span class="p">(</span><span class="s">&#39;./&#39;</span><span class="p">,</span> <span class="n">zipf</span><span class="p">,</span> <span class="n">ignore_list</span><span class="o">=</span><span class="n">ignore_list</span><span class="p">)</span>
</span><span class='line'>        <span class="n">zipf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span class='line'>        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;File size: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">location</span><span class="p">)))</span>
</span><span class='line'>    <span class="k">finally</span><span class="p">:</span>
</span><span class='line'>        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>The code I added to set up the ignore_list is:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'>    <span class="k">if</span> <span class="n">ignore_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
</span><span class='line'>        <span class="n">ignore_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="n">ignore_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;.gitignore&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>So my updated function looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">zip_up_folder</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">ignore_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
</span><span class='line'>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span class='line'>    <span class="k">try</span><span class="p">:</span>
</span><span class='line'>        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span><span class='line'>        <span class="n">io</span><span class="o">.</span><span class="n">log_info</span><span class="p">(</span><span class="s">&#39;Zipping up folder at location: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
</span><span class='line'>        <span class="n">zipf</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_DEFLATED</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="n">ignore_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
</span><span class='line'>            <span class="n">ignore_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>        <span class="n">ignore_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;.gitignore&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">_zipdir</span><span class="p">(</span><span class="s">&#39;./&#39;</span><span class="p">,</span> <span class="n">zipf</span><span class="p">,</span> <span class="n">ignore_list</span><span class="o">=</span><span class="n">ignore_list</span><span class="p">)</span>
</span><span class='line'>        <span class="n">zipf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span class='line'>        <span class="n">LOG</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;File size: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">location</span><span class="p">)))</span>
</span><span class='line'>    <span class="k">finally</span><span class="p">:</span>
</span><span class='line'>        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>After updating that code and doing another <code>eb deploy</code> my set of WARs were all happily running in a single EC2 instance as I&rsquo;d expect.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2015/07/24/how-would-you-implement-cron-on-aws-as-inexpensively-as-possible/">How Would You Implement &#8220;Cron&#8221; on AWS as Inexpensively as Possible?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-07-24T09:20:15-04:00" pubdate data-updated="true">Jul 24<span>th</span>, 2015</time>
        
           | <a href="/archives/2015/07/24/how-would-you-implement-cron-on-aws-as-inexpensively-as-possible/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2015/07/24/how-would-you-implement-cron-on-aws-as-inexpensively-as-possible/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There seems to be a common problem I&rsquo;ve seen in app developer threads.  CloudKit provides tons of functionality to run your app without your own infrastructure but it only runs the APIs they provide.  There is an Android syncing API that provides similar things but with the same limitations.  Lots of app developers are really cheap because they&rsquo;re testing the water to see if their app is worth spending money on or not.</p>

<p>The problem: You need to do some simple processing on a data set and give the processed data set to your users.</p>

<p>The solution: Run a scheduled job that processes the data and puts it in S3.</p>

<p>The constraints:  You must use AWS.  The cost must be under $9 / month (less than a t2.micro) and cheaper is better.  You can&rsquo;t run it on your laptop/Raspberry Pi.  It must run at least once per day.</p>

<p>I think it&rsquo;s a fun exercise to see how this problem can be solved.  As I&rsquo;m learning more and more about AWS there seem to be multiple ways to do it so I&rsquo;m interested in seeing what other people come up with.</p>

<p>Some possible solutions I&rsquo;ve seen so far:</p>

<ul>
<li><p><a href="https://www.youtube.com/watch?v=UFj27laTWQA&amp;feature=youtu.be&amp;t=42m50s">AWS Lambda plans to offer support for &ldquo;timed events&rdquo;</a> but it isn&rsquo;t there yet</p></li>
<li><p>The <a href="https://alestic.com/2015/05/aws-lambda-recurring-schedule/">Unreliable Town Clock setup</a>, another AWS Lambda technique</p></li>
<li><p><a href="http://stackoverflow.com/a/31415241/796579">SQS, plus CloudWatch, plus SNS, plus Lambda</a>, sounds elaborate but actually this is my favorite so far since it is available now and doesn&rsquo;t depend on the Unreliable Town Clock.  However, there are gotchas with it.</p></li>
</ul>


<p>How would you do it?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2015/03/10/validating-guava-event-bus-interactions-with-mockito/">Validating Guava Event Bus Interactions With Mockito</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-03-10T18:43:15-04:00" pubdate data-updated="true">Mar 10<span>th</span>, 2015</time>
        
           | <a href="/archives/2015/03/10/validating-guava-event-bus-interactions-with-mockito/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2015/03/10/validating-guava-event-bus-interactions-with-mockito/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Are you using <a href="https://code.google.com/p/guava-libraries/wiki/EventBusExplained">Guava&rsquo;s event bus</a> in your Java project?  Do you need to test and validate interactions with the event bus but are having trouble?  Mockito can help you out here with just a few lines of code.</p>

<p>Assume you have two event types.  We&rsquo;ll call them <code>WantedEvent</code> and <code>UnwantedEvent</code>.  In your test you can use Mockito to create a mock event bus like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">mockEventBus</span> <span class="o">=</span> <span class="n">mock</span><span class="o">(</span><span class="n">EventBus</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then you can use Mockito&rsquo;s <code>doAnswer</code> functionality to intercept all interactions with the event bus and do something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">doAnswer</span><span class="o">(</span><span class="k">new</span> <span class="n">Answer</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;()</span> <span class="o">{</span>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="n">Void</span> <span class="nf">answer</span><span class="o">(</span><span class="n">InvocationOnMock</span> <span class="n">invocationOnMock</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Throwable</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">Object</span> <span class="n">argument</span> <span class="o">=</span> <span class="n">invocationOnMock</span><span class="o">.</span><span class="na">getArguments</span><span class="o">()[</span><span class="mi">0</span><span class="o">];</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">if</span> <span class="o">(</span><span class="n">argument</span> <span class="k">instanceof</span> <span class="n">WantedEvent</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">wantedEventCount</span><span class="o">++;</span>
</span><span class='line'>        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">argument</span> <span class="k">instanceof</span> <span class="n">UnwantedEvent</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">unwantedEventCount</span><span class="o">++;</span>
</span><span class='line'>        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">(</span><span class="s">&quot;This kind of event was not expected&quot;</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}).</span><span class="na">when</span><span class="o">(</span><span class="n">mockEventBus</span><span class="o">).</span><span class="na">post</span><span class="o">(</span><span class="n">anyObject</span><span class="o">());</span>
</span></code></pre></td></tr></table></div></figure>


<p>When you use your event bus in your tests now you&rsquo;ll be counting the number of times <code>WantedEvent</code> and <code>UnwantedEvent</code> are published (you do need to make those variables accessible outside the scope of this anonymous <code>Answer&lt;Void&gt;</code> block).</p>

<p>You&rsquo;ll also be throwing exceptions if you see any other kinds of events that you didn&rsquo;t expect so you can fail immediately if there is additional unwanted behavior going on.  Naturally you can leave the else part out and ignore other events completely too.</p>

<p>Using this simple pattern I&rsquo;ve been able to debug, test, and be confident in the implementation of several projects that use the Guava event bus.</p>

<p>Do you have any tricks or tips related to this article?  Is there a better or easier way to do what I&rsquo;m doing here?  Did this get you out of a bind?  Post in the comments!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2014/12/16/mockito-and-servletinputstreams/">Mockito and ServletInputStreams</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-12-16T07:00:22-05:00" pubdate data-updated="true">Dec 16<span>th</span>, 2014</time>
        
           | <a href="/archives/2014/12/16/mockito-and-servletinputstreams/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2014/12/16/mockito-and-servletinputstreams/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I was working on a few applications that involve servlets recently and I came across a situation that initially seemed challenging to test with <a href="https://github.com/mockito/mockito">Mockito</a>.  I wanted to do something relatively simple which was read a <a href="https://github.com/google/protobuf/">Protobuf</a> sent from a client, turn it into an object, and do some processing on it.</p>

<p>The question is how do you test a servlet that needs to get the input stream from a servlet request?</p>

<p>I found <a href="https://stackoverflow.com/questions/13353545/mocking-multipart-mime-request-with-mockito">a Stack Overflow post that addresses how to do this with an older version of the ServletInputStream</a> but doing it now requires that you override three additional methods (<code>isFinished</code>, <code>isReady</code>, and <code>setReadListener</code>).</p>

<p>My issue with this is that I don&rsquo;t want to override those methods because I don&rsquo;t really know what I want them to do.  If I&rsquo;m mocking something I want to make sure I know when and where it will be used or I want the mocking framework to return default values or throw exceptions so I know where to look when something breaks.</p>

<p>What I landed on was using the <code>thenAnswer</code> method like this:</p>

<figure class='code'><figcaption><span>Mocking a ServletInputStream</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kt">byte</span><span class="o">[]</span> <span class="n">myBinaryData</span> <span class="o">=</span> <span class="s">&quot;TEST&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">();</span>
</span><span class='line'><span class="n">ByteArrayInputStream</span> <span class="n">byteArrayInputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ByteArrayInputStream</span><span class="o">(</span><span class="n">myBinaryData</span><span class="o">);</span>
</span><span class='line'>      
</span><span class='line'><span class="n">mockServletInputStream</span> <span class="o">=</span> <span class="n">mock</span><span class="o">(</span><span class="n">ServletInputStream</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="n">when</span><span class="o">(</span><span class="n">mockServletInputStream</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">Matchers</span><span class="o">.&lt;</span><span class="kt">byte</span><span class="o">[]&gt;</span><span class="n">any</span><span class="o">(),</span> <span class="n">anyInt</span><span class="o">(),</span> <span class="n">anyInt</span><span class="o">())).</span><span class="na">thenAnswer</span><span class="o">(</span><span class="k">new</span> <span class="n">Answer</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;()</span> <span class="o">{</span>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">answer</span><span class="o">(</span><span class="n">InvocationOnMock</span> <span class="n">invocationOnMock</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Throwable</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span> <span class="o">=</span> <span class="n">invocationOnMock</span><span class="o">.</span><span class="na">getArguments</span><span class="o">();</span>
</span><span class='line'>        <span class="kt">byte</span><span class="o">[]</span> <span class="n">output</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">[])</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
</span><span class='line'>        <span class="kt">int</span> <span class="n">offset</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
</span><span class='line'>        <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="n">args</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">byteArrayInputStream</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">output</span><span class="o">,</span> <span class="n">offset</span><span class="o">,</span> <span class="n">length</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you need to ever mock a ServletInputStream feel free to use this code to do it.  So far it has worked perfectly for me.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2014/11/12/fixing-javac-on-mac-os-when-multiple-jvms-are-installed/">Fixing Javac on Mac OS When Multiple JVMs Are Installed</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-12T06:59:45-05:00" pubdate data-updated="true">Nov 12<span>th</span>, 2014</time>
        
           | <a href="/archives/2014/11/12/fixing-javac-on-mac-os-when-multiple-jvms-are-installed/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2014/11/12/fixing-javac-on-mac-os-when-multiple-jvms-are-installed/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For some reason I decided to install the Java 8 JDK a few days ago when I upgraded to Yosemite.  In IntelliJ it isn&rsquo;t a problem but on the command-line it isn&rsquo;t so nice.  Here&rsquo;s what I get when I try to use javac:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> javac src/com/timmattison/Main.java
</span><span class='line'><span class="go">warning: /Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/lang/Object.class): major version 52 is newer than 51, the highest major version supported by this compiler.</span>
</span><span class='line'><span class="go">It is recommended that the compiler be upgraded.</span>
</span><span class='line'><span class="go">warning: /Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/lang/String.class): major version 52 is newer than 51, the highest major version supported by this compiler.</span>
</span><span class='line'><span class="go">It is recommended that the compiler be upgraded.</span>
</span><span class='line'><span class="go">/Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/lang/Object.class): warning: Cannot find annotation method &#39;value()&#39; in type &#39;Profile+Annotation&#39;: class file for jdk.Profile+Annotation not found</span>
</span><span class='line'><span class="go">/Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/lang/String.class): warning: Cannot find annotation method &#39;value()&#39; in type &#39;Profile+Annotation&#39;</span>
</span><span class='line'><span class="go">warning: /Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/lang/AutoCloseable.class): major version 52 is newer than 51, the highest major version supported by this compiler.</span>
</span><span class='line'><span class="go">It is recommended that the compiler be upgraded.</span>
</span><span class='line'><span class="go">/Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/lang/AutoCloseable.class): warning: Cannot find annotation method &#39;value()&#39; in type &#39;Profile+Annotation&#39;</span>
</span><span class='line'><span class="go">warning: /Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/lang/System.class): major version 52 is newer than 51, the highest major version supported by this compiler.</span>
</span><span class='line'><span class="go">It is recommended that the compiler be upgraded.</span>
</span><span class='line'><span class="go">/Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/lang/System.class): warning: Cannot find annotation method &#39;value()&#39; in type &#39;Profile+Annotation&#39;</span>
</span><span class='line'><span class="go">warning: /Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/io/PrintStream.class): major version 52 is newer than 51, the highest major version supported by this compiler.</span>
</span><span class='line'><span class="go">It is recommended that the compiler be upgraded.</span>
</span><span class='line'><span class="go">/Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/io/PrintStream.class): warning: Cannot find annotation method &#39;value()&#39; in type &#39;Profile+Annotation&#39;</span>
</span><span class='line'><span class="go">warning: /Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/io/FilterOutputStream.class): major version 52 is newer than 51, the highest major version supported by this compiler.</span>
</span><span class='line'><span class="go">It is recommended that the compiler be upgraded.</span>
</span><span class='line'><span class="go">/Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/io/FilterOutputStream.class): warning: Cannot find annotation method &#39;value()&#39; in type &#39;Profile+Annotation&#39;</span>
</span><span class='line'><span class="go">warning: /Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/lib/ct.sym(META-INF/sym/rt.jar/java/io/OutputStream.class): major version 52 is newer than 51, the highest major version supported by this compiler.</span>
</span><span class='line'><span class="go">It is recommended that the compiler be upgraded.</span>
</span></code></pre></td></tr></table></div></figure>


<p>When I run <code>javac -version</code> I get mostly what I&rsquo;d expect:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> javac -version
</span><span class='line'><span class="go">javac 1.7.0_45</span>
</span></code></pre></td></tr></table></div></figure>


<p>So why is it trying to use libraries from the Java 8 JDK?  Simply because I forgot to set JAVA_HOME.  On Mac OS you can quickly fix this by adding the following line to your .bash_profile and starting a new Terminal session:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">export JAVA_HOME=&quot;/Library/Java/JavaVirtualMachines/jdk1.7.0_45.jdk/Contents/Home/&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Of course you should change <code>_45</code> to reflect the specific version you&rsquo;re running and validate that the path in the <code>JAVA_HOME</code> variable exists.</p>

<p>Good luck!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2014/11/12/when-unicode-goes-wrong-in-java/">When Unicode Goes Wrong in Java</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-12T06:50:31-05:00" pubdate data-updated="true">Nov 12<span>th</span>, 2014</time>
        
           | <a href="/archives/2014/11/12/when-unicode-goes-wrong-in-java/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2014/11/12/when-unicode-goes-wrong-in-java/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>NOTE: This is only guaranteed to work with the Sun JVM since this option is <a href="https://stackoverflow.com/questions/2168350/java-charset-problem-on-linux?answertab=votes#tab-top">&ldquo;an internal detail of Sun&rsquo;s implementations&rdquo;</a>.</p>

<p>UPDATE 2014-11-12 6:22 PM: The real fix is to set the environment variable LANG to <code>en_US.UTF-8</code> right before you start your JVM.</p>

<p>Is Unicode breaking in your application and you can&rsquo;t figure out where?  Maybe data from HttpClient is coming back mangled, maybe database queries via JDBC are having Unicode data replaced with question marks, maybe your <a href="https://code.google.com/p/protobuf/">protobufs</a> are getting shredded, but somewhere something is eating your Unicode data and nothing you&rsquo;ve tried fixes it.  Well&hellip;</p>

<p>Did you know the JVM itself has a global Unicode setting specified by the <code>-Dfile.encoding</code> option?  Most people I talked to didn&rsquo;t know about it, myself included, when I ran into a Unicode issue on a project.  After some great teamwork and research we found this option, set it, and everything started working again.</p>

<p>All we had to do was put <code>-Dfile.encoding=UTF8</code> in the script that ran our JVM and everything was fixed but that was only a temporary fix.  You really need to set LANG to <code>en_US.UTF-8</code>.  If you want to play with it <a href="https://github.com/timmattison/jvm-unicode-settings">I created a test project on Github</a> that is incredibly simple and shows the right and wrong settings and what they do to a simple trademark symbol.  Otherwise, try this on your project and see if it fixes the issue.</p>

<p>Good luck!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2014/10/30/using-interfaces-in-camels-java-dsl-with-spring/">Using Interfaces in Camel&#8217;s Java DSL With Spring</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-30T16:29:26-04:00" pubdate data-updated="true">Oct 30<span>th</span>, 2014</time>
        
           | <a href="/archives/2014/10/30/using-interfaces-in-camels-java-dsl-with-spring/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2014/10/30/using-interfaces-in-camels-java-dsl-with-spring/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When writing some routes with Camel&rsquo;s Java DSL I came across this exception:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Caused by: java.lang.IllegalStateException: No method invocation could be created, no matching method could be found on: null</span></code></pre></td></tr></table></div></figure>


<p>After a lot of tracing I figured out that it was related to me calling the <code>.bean(...)</code> method with a class that was actually just an interface.  What was happening was that Camel wants to instantiate this class, usually using Spring, but cannot do that if it isn&rsquo;t a concrete implementation.</p>

<p>This proved to be a real problem because I had an interface that had two implementations.  One of these implementations is used for debugging and the other is used for production.  I didn&rsquo;t want to have to manually select which one I was using in my code because that&rsquo;s Spring&rsquo;s job so I came up with a way to do it.</p>

<p>For the complete background here&rsquo;s what my interface looks like:</p>

<figure class='code'><figcaption><span>The interface</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">import</span> <span class="nn">org.apache.camel.Processor</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ProtobufToWire</span> <span class="kd">extends</span> <span class="n">Processor</span> <span class="o">{</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This converts a Protobuf to our &ldquo;wire&rdquo; format.  That format could be the native protobuf binary format or JSON.  I implement this empty interface in two classes called <code>ProtobufToBinary</code> and <code>ProtobufToJson</code> and I want to use the JSON one only for debugging.</p>

<p>To be clear doing this always fails with the exception I listed above:</p>

<figure class='code'><figcaption><span>A route that always fails</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">from</span><span class="o">(</span><span class="n">SOME_URI</span><span class="o">).</span><span class="na">bean</span><span class="o">(</span><span class="n">ProtobufToWire</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>To fix this I added this to my Java-based Spring config:</p>

<figure class='code'><figcaption><span>Getting an instance of ProtobufToWire</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="nd">@Bean</span>
</span><span class='line'><span class="kd">public</span> <span class="n">ProtobufToWire</span> <span class="nf">protobufToWire</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nf">ProtobufToBinary</span><span class="o">();</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now because, I believe, that Camel&rsquo;s <code>bean(...)</code> method doesn&rsquo;t look up the beans with Spring this still fails.  What I needed to where I am defining my routes is this:</p>

<figure class='code'><figcaption><span>Finally, how to get Camel to instantiate the right type</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'>    <span class="nd">@Autowired</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">ProtobufToWire</span> <span class="n">protobufToWire</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">from</span><span class="o">(</span><span class="n">SOME_URI</span><span class="o">).</span><span class="na">bean</span><span class="o">(</span><span class="n">protobufToWire</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>What I&rsquo;m doing here is getting Spring to autowire an instance of that interface into a private variable and then asking it for its real concrete type.  Part of me says that I shouldn&rsquo;t have to do this but this is what works for me.</p>

<p>Did this help you out?  Do you have a better way to do it?  Post in the comments!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/2014/10/28/activating-u2f-on-a-yubikey-neo-on-mac-os/">Activating U2F on a Yubikey Neo on Mac OS</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-28T16:25:12-04:00" pubdate data-updated="true">Oct 28<span>th</span>, 2014</time>
        
           | <a href="/archives/2014/10/28/activating-u2f-on-a-yubikey-neo-on-mac-os/#disqus_thread"
             data-disqus-identifier="http://blog.timmattison.com/archives/2014/10/28/activating-u2f-on-a-yubikey-neo-on-mac-os/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I just got my Yubikey Neo with U2F support and I felt like the documentation on how to get it up and running was a bit hard to find.  If you are having trouble getting started with U2F these few quick steps will help you get through it.</p>

<p>Step 0: Download and install the <a href="https://developers.yubico.com/yubikey-neo-manager/Releases/">Yubikey Neo Manager application</a>.  This is NOT the Yubikey Personalization Tool!  The Yubikey Personalization Tool does not support enabling U2F yet.</p>

<p>Step 1: Open the Yubikey Neo Manager with your Yubikey installed and click <code>Change connection mode [OTP]</code> <img src="/images/yubikey-neo-manager/step-1.png" alt="Yubikey Neo Manager main screen" /></p>

<p>Step 2: On the <code>Change connection mode</code> check the <code>U2F</code> box to change the setting from <code>OTP</code> to <code>U2F</code> and click <code>OK</code>. <img src="/images/yubikey-neo-manager/step-2.png" alt="Yubikey Neo Manager main screen" /> <img src="/images/yubikey-neo-manager/step-3.png" alt="Yubikey Neo Manager main screen" /></p>

<p>The application will now prompt you to remove your device.  You can remove it and plug it back in again.  Close the Yubikey Neo Manager application.</p>

<p>Step 3: Open Chrome and install the <a href="https://chrome.google.com/webstore/detail/fido-u2f-universal-2nd-fa/pfboblefjcgdjicmnffhdgionmgcdmne">FIDO U2F (Universal 2nd Factor) extension</a> from the Chrome web store.</p>

<p>Step 4: Register on <a href="http://demo.yubico.com/u2f">Yubico&rsquo;s U2F demo page</a> and you&rsquo;re done.</p>

<p>Now you can log in on the demo page and other sites that support U2F.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/2/">&larr; Older</a>
    
    <a href="/archives">Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Sidebar -->
<ins class="adsbygoogle"
     style="display:inline-block;width:120px;height:240px"
     data-ad-client="ca-pub-9307090849713032"
     data-ad-slot="1616086903"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/archives/2015/07/30/image-metadata-extraction-with-aws-lambda-and-java/">Image Metadata Extraction With AWS Lambda and Java</a>
      </li>
    
      <li class="post">
        <a href="/archives/2015/07/30/deploying-multiple-java-applications-in-a-single-elastic-beanstalk-instance/">Deploying Multiple Java Applications in a Single Elastic Beanstalk Instance</a>
      </li>
    
      <li class="post">
        <a href="/archives/2015/07/27/deploying-multiple-war-files-on-a-single-instance-with-elastic-beanstalks-command-line-tools/">Deploying Multiple WAR Files on a Single Instance With Elastic Beanstalk&#8217;s Command-line Tools</a>
      </li>
    
      <li class="post">
        <a href="/archives/2015/07/24/how-would-you-implement-cron-on-aws-as-inexpensively-as-possible/">How Would You Implement &#8220;Cron&#8221; on AWS as Inexpensively as Possible?</a>
      </li>
    
      <li class="post">
        <a href="/archives/2015/03/10/validating-guava-event-bus-interactions-with-mockito/">Validating Guava Event Bus Interactions With Mockito</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/timmattison">@timmattison</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'timmattison',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/timmattison?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Tim Mattison -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'timmattison';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
